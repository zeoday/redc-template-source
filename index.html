<!DOCTYPE html>
<html lang="zh-CN" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO & Meta Tags -->
    <title>Redc - 红队基础设施多云自动化部署工具 | Infrastructure as Code</title>
    <meta name="description" content="Redc 是一款基于 Terraform 的红队基础设施自动化工具。支持 MCP 协议与 AI 助手集成，提供 Compose 服务编排，一键自动化部署多云（阿里云、AWS、腾讯云等）攻防环境。">
    <meta name="keywords" content="Red Team, IaC, Terraform, MCP, Model Context Protocol, Compose, 自动化部署, 红队设施, 基础设施即代码, Aliyun, AWS, TencentCloud">
    <meta name="author" content="wgpsec">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://redc.wgpsec.org/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://redc.wgpsec.org/">
    <meta property="og:title" content="Redc - 红队基础设施多云自动化部署工具">
    <meta property="og:description" content="不仅仅是开机工具，更是对云资源的自动化调度器。支持 MCP 协议、多服务编排与多云部署。">
    <meta property="og:image" content="https://redc.wgpsec.org/assets/og-image.png">
    <meta property="og:locale" content="zh_CN">
    <meta property="og:locale:alternate" content="en_US">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://redc.wgpsec.org/">
    <meta property="twitter:title" content="Redc - 红队基础设施多云自动化部署工具">
    <meta property="twitter:description" content="支持 MCP 协议与 AI 助手集成，一键构建、管理和销毁攻防环境。">
    <meta property="twitter:image" content="https://redc.wgpsec.org/assets/og-image.png">

    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    
    <!-- Dependencies -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.6/purify.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.2.0/github-markdown-dark.min.css">
    
    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Redc",
      "operatingSystem": "Linux, macOS, Windows",
      "applicationCategory": "DeveloperApplication",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "description": "红队基础设施多云自动化部署工具，支持 MCP 协议与 Compose 编排。",
      "author": {
        "@type": "Organization",
        "name": "WGPSec"
      }
    }
    </script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dark: {
                            bg: '#0B0C15',
                            card: '#151725',
                            border: '#2A2D3D',
                            hover: '#1E2030'
                        },
                        primary: {
                            400: '#818cf8',
                            500: '#6366f1', // Indigo
                            600: '#4f46e5',
                            900: '#312e81'
                        }
                    },
                    maxWidth: {
                        '8xl': '90rem'
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out',
                        'slide-up': 'slideUp 0.5s ease-out',
                        'blob': 'blob 10s infinite'
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        slideUp: { '0%': { transform: 'translateY(20px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
                        blob: {
                            '0%': { transform: 'translate(0px, 0px) scale(1)' },
                            '33%': { transform: 'translate(30px, -50px) scale(1.1)' },
                            '66%': { transform: 'translate(-20px, 20px) scale(0.9)' },
                            '100%': { transform: 'translate(0px, 0px) scale(1)' }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* 全局样式 */
        body { background-color: #0B0C15; color: #e2e8f0; overflow-x: hidden; }
        
        /* 磨砂玻璃效果 */
        .glass-panel {
            background: rgba(21, 23, 37, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        
        .glass-card {
            background: linear-gradient(145deg, rgba(30, 32, 45, 0.6) 0%, rgba(21, 23, 37, 0.4) 100%);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .glass-card:hover {
            transform: translateY(-4px);
            border-color: rgba(99, 102, 241, 0.4);
            box-shadow: 0 10px 40px -10px rgba(99, 102, 241, 0.2);
        }

        /* 滚动条美化 */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }

        /* 动态背景光晕 */
        .blob-bg {
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            z-index: -1;
            overflow: hidden;
            pointer-events: none;
        }
        .blob {
            position: absolute;
            filter: blur(80px);
            opacity: 0.4;
            border-radius: 50%;
            animation: blob 10s infinite alternate;
        }

        /* 表格样式 */
        .custom-table th { font-weight: 600; text-transform: uppercase; font-size: 0.75rem; letter-spacing: 0.05em; color: #94a3b8; padding: 1rem; border-bottom: 1px solid #2A2D3D; }
        .custom-table td { padding: 1rem; border-bottom: 1px solid #1e293b; color: #cbd5e1; font-size: 0.875rem; }
        .custom-table tr:last-child td { border-bottom: none; }
        .custom-table tr:hover td { background-color: rgba(99, 102, 241, 0.05); }

        /* 视图切换按钮激活状态 */
        .view-btn.active { background-color: rgba(99, 102, 241, 0.2); color: #818cf8; border-color: rgba(99, 102, 241, 0.4); }

        /* 代码块样式优化 */
        .code-block {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        }
        
        /* Filter Button Active State */
        .filter-btn.active {
            background-color: rgba(99, 102, 241, 0.2);
            color: #818cf8;
            border-color: rgba(99, 102, 241, 0.5);
        }

        /* Feature Badge */
        .feature-badge {
            font-size: 0.65rem;
            padding: 0.1rem 0.4rem;
            border-radius: 0.25rem;
            background: rgba(99, 102, 241, 0.1);
            color: #818cf8;
            border: 1px solid rgba(99, 102, 241, 0.2);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* 修复小标题的行高问题 */
        h4 { line-height: 1.4; }
    </style>
</head>
<body class="min-h-screen font-sans selection:bg-primary-500 selection:text-white">

    <!-- 导航栏 -->
    <nav class="fixed top-0 w-full z-40 bg-[#0B0C15]/80 backdrop-blur-md border-b border-slate-800">
        <div class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-10 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-primary-500 to-purple-600 flex items-center justify-center text-white font-bold text-lg shadow-lg shadow-primary-500/20">R</div>
                <span class="font-bold text-xl text-white tracking-tight">Redc</span>
            </div>
            <div class="flex items-center gap-3">
                <button id="lang-switcher" onclick="toggleLanguage()"
                    class="px-3 py-1.5 rounded-lg text-slate-400 hover:text-white hover:bg-slate-800 transition text-sm font-medium flex items-center gap-2">
                    <i data-lucide="languages" class="w-4 h-4"></i>
                    <span id="lang-text">EN</span>
                </button>
                <a href="https://github.com/wgpsec/redc" target="_blank" rel="noopener noreferrer"
                   class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-white/5 border border-white/10 text-slate-200 hover:bg-white/10 hover:text-white transition text-sm font-medium">
                    <i data-lucide="github" class="w-4 h-4"></i>
                    <span>GitHub</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- 背景 -->
    <div class="blob-bg">
        <div class="blob bg-purple-900/30 w-96 h-96 top-0 -left-20"></div>
        <div class="blob bg-primary-900/30 w-96 h-96 bottom-0 -right-20 animation-delay-2000"></div>
    </div>

    <div class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-10 pt-28 pb-12">
        
        <!-- Hero Section -->
        <header class="text-center mb-16 animate-slide-up">
            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-primary-500/10 border border-primary-500/20 text-primary-400 text-xs font-medium mb-6">
                <span class="relative flex h-2 w-2">
                  <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary-500 opacity-75"></span>
                  <span class="relative inline-flex rounded-full h-2 w-2 bg-primary-500"></span>
                </span>
                <span data-i18n="hero_badge">Red Team Infrastructure Automation</span>
            </div>
            
            <h1 class="text-5xl md:text-7xl font-extrabold tracking-tight text-white mb-6 leading-tight">
                Red Team <br class="hidden md:block" />
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-primary-400 to-purple-400">
                    Infrastructure as Code
                </span>
            </h1>
            
            <p class="text-slate-400 text-lg md:text-xl max-w-3xl mx-auto mb-10 leading-relaxed" data-i18n="hero_description">
                基于 Terraform 的红队基础设施自动化工具。<br>支持 MCP 协议、Compose 编排，一条命令交付攻防环境。
            </p>

            <!-- Feature Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 max-w-6xl mx-auto mb-12 text-left">
                <!-- Multi-Cloud -->
                <div class="glass-panel p-6 rounded-2xl border-l-4 border-l-primary-500 hover:bg-[#151725]/50 transition">
                    <div class="w-10 h-10 rounded-lg bg-primary-500/20 flex items-center justify-center text-primary-400 mb-4">
                        <i data-lucide="cloud" class="w-6 h-6"></i>
                    </div>
                    <h3 class="text-white font-bold text-lg mb-2" data-i18n="feat_cloud_title">多云支持</h3>
                    <p class="text-slate-400 text-xs leading-relaxed" data-i18n="feat_cloud_desc">适配阿里云、腾讯云、AWS、Azure、GCP 等主流厂商，环境一键拉起。</p>
                </div>
                
                <!-- IaC & State -->
                <div class="glass-panel p-6 rounded-2xl border-l-4 border-l-purple-500 hover:bg-[#151725]/50 transition">
                    <div class="w-10 h-10 rounded-lg bg-purple-500/20 flex items-center justify-center text-purple-400 mb-4">
                        <i data-lucide="database" class="w-6 h-6"></i>
                    </div>
                    <h3 class="text-white font-bold text-lg mb-2" data-i18n="feat_iac_title">状态管理</h3>
                    <p class="text-slate-400 text-xs leading-relaxed" data-i18n="feat_iac_desc">本地保存资源状态，一条命令销毁环境，杜绝资源浪费。</p>
                </div>

                <!-- MCP Protocol -->
                <div class="glass-panel p-6 rounded-2xl border-l-4 border-l-emerald-500 hover:bg-[#151725]/50 transition relative overflow-hidden group">
                    <div class="absolute top-0 right-0 p-2 opacity-10 group-hover:opacity-20 transition">
                        <i data-lucide="bot" class="w-24 h-24 text-emerald-500"></i>
                    </div>
                    <div class="w-10 h-10 rounded-lg bg-emerald-500/20 flex items-center justify-center text-emerald-400 mb-4">
                        <i data-lucide="cpu" class="w-6 h-6"></i>
                    </div>
                    <div class="flex items-center gap-2 mb-2">
                        <h3 class="text-white font-bold text-lg" data-i18n="feat_mcp_title">MCP 支持</h3>
                        <span class="feature-badge">New</span>
                    </div>
                    <p class="text-slate-400 text-xs leading-relaxed" data-i18n="feat_mcp_desc">支持模型上下文协议，与 AI 助手无缝集成，自然语言管理设施。</p>
                </div>

                <!-- Compose Orchestration -->
                <div class="glass-panel p-6 rounded-2xl border-l-4 border-l-orange-500 hover:bg-[#151725]/50 transition relative overflow-hidden group">
                    <div class="absolute top-0 right-0 p-2 opacity-10 group-hover:opacity-20 transition">
                        <i data-lucide="layers" class="w-24 h-24 text-orange-500"></i>
                    </div>
                    <div class="w-10 h-10 rounded-lg bg-orange-500/20 flex items-center justify-center text-orange-400 mb-4">
                        <i data-lucide="workflow" class="w-6 h-6"></i>
                    </div>
                    <div class="flex items-center gap-2 mb-2">
                        <h3 class="text-white font-bold text-lg" data-i18n="feat_compose_title">服务编排</h3>
                        <span class="feature-badge">New</span>
                    </div>
                    <p class="text-slate-400 text-xs leading-relaxed" data-i18n="feat_compose_desc">支持 Compose 编排，通过 YAML 同时管理多个云服务实例。</p>
                </div>
            </div>
        </header>

        <!-- Quick Start Section -->
        <section class="max-w-7xl mx-auto mb-12 animate-slide-up" style="animation-delay: 0.05s;">
            <div class="text-center mb-8">
                <h2 class="text-2xl font-bold text-white mb-2" data-i18n="guide_title">Quick Start</h2>
                <p class="text-slate-400 text-sm" data-i18n="guide_subtitle">Get your infrastructure running in minutes</p>
            </div>
            
            <div class="glass-panel rounded-2xl p-1 shadow-2xl">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-1">
                    <!-- Step 1: Install -->
                    <div class="bg-[#151725]/60 rounded-xl p-5 border border-slate-800/50 hover:bg-[#151725] transition relative overflow-hidden">
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-lg bg-primary-500/10 text-primary-400 border border-primary-500/20 flex items-center justify-center text-sm font-bold font-mono">1</div>
                                <h3 class="font-semibold text-white" data-i18n="step1_title">Install</h3>
                            </div>
                            <a href="https://github.com/wgpsec/redc/releases" target="_blank" class="flex items-center gap-1.5 px-2.5 py-1 rounded bg-slate-800 hover:bg-primary-600 text-[10px] text-slate-300 hover:text-white transition font-medium border border-slate-700">
                                <i data-lucide="download" class="w-3 h-3"></i> Windows
                            </a>
                        </div>
                        <div class="bg-[#0B0C15] rounded-lg p-3 border border-slate-800 group relative">
                            <code class="text-xs text-primary-300 code-block block mb-1">brew tap wgpsec/tap</code>
                            <code class="text-xs text-primary-300 code-block">brew install wgpsec/tap/redc</code>
                            <button onclick="copyCommand('brew tap wgpsec/tap && brew install wgpsec/tap/redc')" class="absolute top-2 right-2 text-slate-500 hover:text-white transition"><i data-lucide="copy" class="w-3 h-3"></i></button>
                        </div>
                    </div>

                    <!-- Step 2: Configure -->
                    <div class="bg-[#151725]/60 rounded-xl p-5 border border-slate-800/50 hover:bg-[#151725] transition relative">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-8 h-8 rounded-lg bg-yellow-500/10 text-yellow-400 border border-yellow-500/20 flex items-center justify-center text-sm font-bold font-mono">2</div>
                            <h3 class="font-semibold text-white" data-i18n="step2_title">Configure</h3>
                        </div>
                        <div class="bg-[#0B0C15] rounded-lg border border-slate-800 overflow-hidden h-[62px]">
                            <div class="flex border-b border-slate-800">
                                <button onclick="switchConfigTab('file')" id="tab-file" class="flex-1 text-[10px] py-1 text-center transition">Config File</button>
                                <button onclick="switchConfigTab('env')" id="tab-env" class="flex-1 text-[10px] py-1 text-center transition">Env Vars</button>
                            </div>
                            <div id="content-file" class="p-2 relative h-full">
                                <code class="text-xs text-yellow-300 code-block">vim ~/redc/config.yaml</code>
                                <button onclick="copyCommand('vim ~/redc/config.yaml')" class="absolute top-2 right-2 text-slate-500 hover:text-white transition"><i data-lucide="copy" class="w-3 h-3"></i></button>
                            </div>
                            <div id="content-env" class="p-2 relative h-full hidden">
                                <code class="text-xs text-yellow-300 code-block">export AWS_ACCESS_KEY_...</code>
                                <button onclick="copyCommand('export AWS_ACCESS_KEY_ID=...')" class="absolute top-2 right-2 text-slate-500 hover:text-white transition"><i data-lucide="copy" class="w-3 h-3"></i></button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Pull -->
                    <div class="bg-[#151725]/60 rounded-xl p-5 border border-slate-800/50 hover:bg-[#151725] transition relative">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-8 h-8 rounded-lg bg-green-500/10 text-green-400 border border-green-500/20 flex items-center justify-center text-sm font-bold font-mono">3</div>
                            <h3 class="font-semibold text-white" data-i18n="step3_title">Pull</h3>
                        </div>
                        <div class="bg-[#0B0C15] rounded-lg p-3 border border-slate-800 relative h-[62px] flex items-center">
                            <code class="text-xs text-green-300 code-block w-full">redc pull aliyun/ecs</code>
                            <button onclick="copyCommand('redc pull aliyun/ecs')" class="absolute top-1/2 -translate-y-1/2 right-2 text-slate-500 hover:text-white transition"><i data-lucide="copy" class="w-3 h-3"></i></button>
                        </div>
                    </div>

                    <!-- Step 4: Run -->
                    <div class="bg-[#151725]/60 rounded-xl p-5 border border-slate-800/50 hover:bg-[#151725] transition relative">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-8 h-8 rounded-lg bg-blue-500/10 text-blue-400 border border-blue-500/20 flex items-center justify-center text-sm font-bold font-mono">4</div>
                            <h3 class="font-semibold text-white" data-i18n="step4_title">Run</h3>
                        </div>
                        <div class="bg-[#0B0C15] rounded-lg p-3 border border-slate-800 relative h-[62px] flex items-center">
                            <code class="text-xs text-blue-300 code-block w-full">redc run aliyun/ecs</code>
                            <button onclick="copyCommand('redc run aliyun/ecs')" class="absolute top-1/2 -translate-y-1/2 right-2 text-slate-500 hover:text-white transition"><i data-lucide="copy" class="w-3 h-3"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Cheatsheet Section -->
        <section class="max-w-7xl mx-auto mb-20 animate-slide-up" style="animation-delay: 0.1s;">
            <div class="glass-panel rounded-xl p-6 border border-slate-800/60">
                <h3 class="text-sm font-bold text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                    <i data-lucide="terminal" class="w-4 h-4"></i> <span data-i18n="cheatsheet_title">Cheatsheet</span>
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-[#0B0C15]/50 border border-slate-800 rounded-lg p-3 flex justify-between items-center group hover:border-primary-500/30 transition">
                        <div>
                            <div class="text-xs text-slate-500 font-bold uppercase mb-1" data-i18n="cmd_status_title">Status</div>
                            <code class="text-sm text-slate-200 font-mono">redc ps</code>
                        </div>
                        <button onclick="copyCommand('redc ps')" class="p-2 text-slate-600 hover:text-white transition"><i data-lucide="copy" class="w-4 h-4"></i></button>
                    </div>
                    <div class="bg-[#0B0C15]/50 border border-slate-800 rounded-lg p-3 flex justify-between items-center group hover:border-primary-500/30 transition">
                        <div class="overflow-hidden">
                            <div class="text-xs text-slate-500 font-bold uppercase mb-1" data-i18n="cmd_exec_title">Execute</div>
                            <code class="text-sm text-slate-200 font-mono truncate block">redc exec &lt;id&gt; whoami</code>
                        </div>
                        <button onclick="copyCommand('redc exec <id> whoami')" class="p-2 text-slate-600 hover:text-white transition"><i data-lucide="copy" class="w-4 h-4"></i></button>
                    </div>
                    <div class="bg-[#0B0C15]/50 border border-slate-800 rounded-lg p-3 flex justify-between items-center group hover:border-primary-500/30 transition">
                        <div class="overflow-hidden">
                            <div class="text-xs text-slate-500 font-bold uppercase mb-1" data-i18n="cmd_cp_title">Transfer</div>
                            <code class="text-sm text-slate-200 font-mono truncate block">redc cp file &lt;id&gt;:/root</code>
                        </div>
                        <button onclick="copyCommand('redc cp file <id>:/root')" class="p-2 text-slate-600 hover:text-white transition"><i data-lucide="copy" class="w-4 h-4"></i></button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Filter Controls -->
        <div class="sticky top-20 z-30 mb-6 animate-slide-up" style="animation-delay: 0.15s;">
            <div class="glass-panel rounded-2xl p-4 shadow-xl border border-slate-700/50">
                <!-- Filters -->
                <div class="flex flex-wrap items-center gap-2 mb-4" id="filter-container">
                    <button class="filter-btn active px-3 py-1.5 rounded-lg text-xs font-medium border border-transparent bg-primary-500/20 text-primary-400 transition" onclick="filterByProvider('all')">All</button>
                    <!-- Dynamic filters injected here -->
                </div>

                <!-- Search & View Toggle -->
                <div class="flex flex-col md:flex-row gap-4 justify-between items-center">
                    <div class="relative w-full md:w-96">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i data-lucide="search" class="h-4 w-4 text-slate-400"></i>
                        </div>
                        <input type="text" id="search-input" 
                            class="block w-full pl-10 pr-4 py-2 bg-slate-900/50 border border-slate-700 rounded-xl text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-1 focus:ring-primary-500 transition text-sm"
                            data-i18n-placeholder="search_placeholder"
                            placeholder="Search templates...">
                    </div>

                    <div class="flex items-center gap-4 w-full md:w-auto justify-between md:justify-end">
                        <span id="result-count" class="text-xs text-slate-500 font-mono">Loading...</span>
                        <div class="flex bg-slate-900/50 p-1 rounded-lg border border-slate-700">
                            <button onclick="switchView('grid')" id="btn-grid" class="view-btn active p-1.5 rounded-md text-slate-400 hover:text-white transition" title="Grid View">
                                <i data-lucide="layout-grid" class="w-4 h-4"></i>
                            </button>
                            <button onclick="switchView('table')" id="btn-table" class="view-btn p-1.5 rounded-md text-slate-400 hover:text-white transition" title="Table View">
                                <i data-lucide="list" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Content Container -->
        <div id="content-area" class="animate-slide-up min-h-[400px]" style="animation-delay: 0.2s;">
            <div class="flex flex-col items-center justify-center py-24 text-slate-500">
                <div class="relative">
                    <div class="w-10 h-10 rounded-full border-4 border-slate-700 border-t-primary-500 animate-spin"></div>
                </div>
                <p class="mt-4 font-medium animate-pulse" data-i18n="loading">Loading arsenal...</p>
            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-20 pt-8 border-t border-slate-800/50 text-center">
            <p class="text-slate-500 text-sm mb-2" id="build-info"></p>
            <div class="flex justify-center gap-6 text-slate-600 mt-6 text-sm">
                <a href="https://github.com/wgpsec/redc" class="hover:text-primary-500 transition">GitHub</a>
                <a href="https://github.com/wgpsec/redc/blob/master/doc/MCP_CN.md" class="hover:text-primary-500 transition">MCP Docs</a>
                <a href="https://github.com/wgpsec/redc/blob/master/doc/Compose_CN.md" class="hover:text-primary-500 transition">Compose Docs</a>
                <a href="https://github.com/wgpsec/redc-template" class="hover:text-primary-500 transition">Templates</a>
            </div>
            <p class="text-slate-600 text-xs mt-4">© WGPSec. Apache 2.0 License.</p>
        </footer>
    </div>

    <!-- Modal -->
    <div id="modal" class="fixed inset-0 z-50 hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="fixed inset-0 bg-black/70 backdrop-blur-sm transition-opacity opacity-0" id="modal-backdrop"></div>
        <div class="fixed inset-0 z-10 overflow-y-auto">
            <div class="flex min-h-full items-center justify-center p-4 text-center sm:p-0">
                <div class="relative transform overflow-hidden rounded-2xl bg-[#0B0C15] border border-slate-700 text-left shadow-2xl transition-all sm:my-8 sm:w-full sm:max-w-5xl opacity-0 scale-95" id="modal-panel">
                    
                    <!-- Modal Header with Metadata -->
                    <div class="bg-[#151725] border-b border-slate-800 sticky top-0 z-20">
                        <div class="px-6 py-4 flex justify-between items-start">
                            <div class="flex-1 mr-8">
                                <h3 class="text-2xl font-bold text-white flex items-center gap-3 mb-4" id="modal-title">
                                    <!-- Populated by JS -->
                                </h3>
                                
                                <!-- Metadata Grid -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm bg-slate-900/50 rounded-xl p-4 border border-slate-800">
                                    <div>
                                        <span class="text-slate-500 block text-xs uppercase font-bold mb-1">Command</span>
                                        <div class="flex items-center gap-2 group cursor-pointer" id="modal-pull-cmd-container">
                                            <code class="text-primary-400 font-mono bg-primary-500/10 px-2 py-0.5 rounded border border-primary-500/20" id="modal-cmd"></code>
                                            <i data-lucide="copy" class="w-3 h-3 text-slate-500 group-hover:text-white transition"></i>
                                        </div>
                                    </div>
                                    <div>
                                        <span class="text-slate-500 block text-xs uppercase font-bold mb-1">Author / Version</span>
                                        <div class="flex items-center gap-3 text-slate-300">
                                            <span class="flex items-center gap-1"><i data-lucide="user" class="w-3 h-3"></i> <span id="modal-author"></span></span>
                                            <span class="text-slate-600">|</span>
                                            <span class="flex items-center gap-1"><i data-lucide="tag" class="w-3 h-3"></i> <span id="modal-version"></span></span>
                                        </div>
                                    </div>
                                    <div class="md:col-span-2">
                                        <span class="text-slate-500 block text-xs uppercase font-bold mb-1">Description</span>
                                        <p class="text-slate-400 text-sm leading-relaxed" id="modal-desc"></p>
                                    </div>
                                </div>
                            </div>
                            <button type="button" class="p-2 rounded-lg text-slate-400 hover:bg-slate-800 hover:text-white transition" onclick="closeModal()">
                                <i data-lucide="x" class="w-6 h-6"></i>
                            </button>
                        </div>
                    </div>

                    <div class="px-8 py-8 bg-[#0B0C15] min-h-[300px] max-h-[60vh] overflow-y-auto custom-scrollbar">
                        <div id="markdown-content" class="markdown-body" style="background: transparent;"></div>
                    </div>

                    <div class="bg-[#151725] px-6 py-4 border-t border-slate-800 flex flex-col sm:flex-row justify-between items-center gap-4">
                        <div class="text-xs text-slate-500 font-mono" id="modal-footer-info"></div>
                        <button onclick="closeModal()" class="px-6 py-2 text-sm font-medium text-white bg-slate-700 hover:bg-slate-600 rounded-lg transition" data-i18n="close">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="fixed bottom-8 right-1/2 translate-x-1/2 sm:right-8 sm:translate-x-0 z-50 pointer-events-none">
        <div class="bg-emerald-500/10 backdrop-blur-md border border-emerald-500/20 text-emerald-400 px-4 py-3 rounded-xl shadow-2xl flex items-center gap-3 transform translate-y-20 transition-all duration-300 opacity-0" id="toast-body">
            <div class="bg-emerald-500/20 p-1 rounded-full"><i data-lucide="check" class="w-4 h-4"></i></div>
            <span class="font-medium text-sm" data-i18n="copied">Command copied</span>
        </div>
    </div>

    <script>
        // --- State ---
        let currentLang = localStorage.getItem('redc-lang') || 'zh-CN';
        let currentView = 'grid'; // 'grid' or 'table'
        let currentFilter = 'all';
        let allTemplates = [];
        let filteredTemplates = [];

        // --- I18N ---
        const translations = {
            'zh-CN': {
                hero_badge: '红队基础设施多云自动化部署工具',
                hero_description: '基于 Terraform 的红队基础设施自动化工具。<br>支持 MCP 协议、Compose 编排，一条命令交付攻防环境。',
                feat_cloud_title: '多云支持',
                feat_cloud_desc: '适配阿里云、腾讯云、AWS、Azure、GCP 等主流厂商，环境一键拉起。',
                feat_iac_title: '状态管理',
                feat_iac_desc: '本地保存资源状态，一条命令销毁环境，杜绝资源浪费。',
                feat_mcp_title: 'MCP 支持',
                feat_mcp_desc: '支持模型上下文协议，与 AI 助手无缝集成，自然语言管理设施。',
                feat_compose_title: '服务编排',
                feat_compose_desc: '支持 Compose 编排，通过 YAML 同时管理多个云服务实例。',
                guide_title: '快速开始',
                guide_subtitle: '只需四步即可部署您的基础设施',
                step1_title: '安装',
                step1_desc: '使用 Homebrew 或下载二进制文件安装 redc 引擎。',
                step2_title: '配置',
                step2_desc: '配置云厂商访问凭证 (AK/SK)。',
                step3_title: '拉取',
                step3_desc: '从仓库中下载所需的场景模版到本地。',
                step4_title: '运行',
                step4_desc: '一条命令 (redc run) 即可完成资源购买与配置。',
                cheatsheet_title: '常用命令',
                cmd_status_title: '查看状态',
                cmd_exec_title: '执行命令',
                cmd_cp_title: '传输文件',
                registry_title: '武器库模版',
                search_placeholder: '搜索模版、云厂商、作者...',
                loading: '正在加载武器库...',
                no_results: '未找到相关模版',
                no_results_hint: '尝试更换关键词或分类。',
                clear_search: '清除搜索',
                click_to_copy: '点击复制',
                close: '关闭',
                copy_command: '复制命令',
                copied: '已复制到剪贴板',
                docs: '文档',
                download_zip: '下载 ZIP',
                no_readme: '> *该模版暂无详细文档*',
                table_provider: '云厂商',
                table_name: '名称',
                table_desc: '描述',
                table_author: '作者',
                table_version: '版本',
                table_action: '操作'
            },
            'en': {
                hero_badge: 'Red Team Infrastructure Automation',
                hero_description: 'Red Team Infrastructure as Code (IaC) tool based on Terraform.<br>Supports MCP, Compose, one-click build, manage and destroy offensive environments.',
                feat_cloud_title: 'Multi-Cloud',
                feat_cloud_desc: 'Support AWS, Aliyun, Tencent, Azure, GCP and more.',
                feat_iac_title: 'State Management',
                feat_iac_desc: 'Local state management, one-click destroy to prevent resource waste.',
                feat_mcp_title: 'MCP Support',
                feat_mcp_desc: 'Model Context Protocol support for seamless AI assistant integration.',
                feat_compose_title: 'Compose',
                feat_compose_desc: 'Orchestrate multiple cloud services via simple YAML configuration.',
                guide_title: 'Quick Start Guide',
                guide_subtitle: 'Get your infrastructure running in minutes',
                step1_title: 'Install',
                step1_desc: 'Install redc engine via Homebrew or binary download.',
                step2_title: 'Configure',
                step2_desc: 'Setup cloud provider AccessKey/SecretKey.',
                step3_title: 'Pull',
                step3_desc: 'Download scenario templates from the registry.',
                step4_title: 'Run',
                step4_desc: 'Provision and configure resources with a single command.',
                cheatsheet_title: 'Cheatsheet',
                cmd_status_title: 'Status',
                cmd_exec_title: 'Exec',
                cmd_cp_title: 'Copy',
                registry_title: 'Template Registry',
                search_placeholder: 'Search templates, providers, authors...',
                loading: 'Loading arsenal...',
                no_results: 'No templates found',
                no_results_hint: 'Try different keywords or filters.',
                clear_search: 'Clear Search',
                click_to_copy: 'Click to copy',
                close: 'Close',
                copy_command: 'Copy Command',
                copied: 'Copied to clipboard',
                docs: 'Docs',
                download_zip: 'Download ZIP',
                no_readme: '> *No detailed documentation*',
                table_provider: 'Provider',
                table_name: 'Name',
                table_desc: 'Description',
                table_author: 'Author',
                table_version: 'Version',
                table_action: 'Action'
            }
        };

        // --- Core Logic ---

        document.addEventListener('DOMContentLoaded', () => {
            setLanguage(currentLang);
            fetchData();
            setupSearch();
            lucide.createIcons();
        });

        async function fetchData() {
            try {
                // Using external URL for testing
                const response = await fetch(`./index.json?t=${new Date().getTime()}`);
                if (!response.ok) throw new Error('Failed to load data');
                const data = await response.json();
                
                if (Array.isArray(data.templates)) {
                    allTemplates = data.templates;
                } else if (typeof data.templates === 'object') {
                    allTemplates = Object.values(data.templates);
                } else {
                    allTemplates = [];
                }

                // Sort by update time
                allTemplates.sort((a, b) => {
                    const dateA = new Date(a.versions?.[a.latest]?.updated_at || a.updated_at || 0);
                    const dateB = new Date(b.versions?.[b.latest]?.updated_at || b.updated_at || 0);
                    return dateB - dateA;
                });

                const buildDate = new Date(data.updated_at || Date.now());
                document.getElementById('build-info').innerHTML = 
                    `Last Updated: <span class="text-slate-400">${buildDate.toLocaleDateString()}</span> • Total: <span class="text-slate-400">${allTemplates.length}</span>`;

                // Render Filters
                renderFilters(allTemplates);

                // Initial Render
                filterTemplates();

            } catch (error) {
                console.error(error);
                document.getElementById('content-area').innerHTML = `
                    <div class="text-center py-20 bg-red-500/10 border border-red-500/20 rounded-2xl mx-auto max-w-2xl">
                        <i data-lucide="alert-triangle" class="w-10 h-10 text-red-500 mx-auto mb-4"></i>
                        <h3 class="text-lg font-bold text-red-400">Failed to load registry</h3>
                        <p class="text-red-400/60 text-sm mt-2">${error.message}</p>
                    </div>`;
                lucide.createIcons();
            }
        }

        // --- Filters ---

        function renderFilters(templates) {
            const providers = new Set();
            templates.forEach(t => {
                const provider = t.provider || t.id.split('/')[0];
                providers.add(provider.toLowerCase());
            });

            const container = document.getElementById('filter-container');
            const sortedProviders = Array.from(providers).sort();

            sortedProviders.forEach(p => {
                const btn = document.createElement('button');
                btn.className = 'filter-btn px-3 py-1.5 rounded-lg text-xs font-medium border border-transparent bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700 transition capitalize';
                btn.textContent = p;
                btn.onclick = () => filterByProvider(p);
                container.appendChild(btn);
            });
        }

        function filterByProvider(provider) {
            currentFilter = provider;
            
            // Update active state
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.textContent.toLowerCase() === provider) {
                    btn.className = 'filter-btn active px-3 py-1.5 rounded-lg text-xs font-medium border border-transparent bg-primary-500/20 text-primary-400 transition capitalize';
                } else {
                    btn.className = 'filter-btn px-3 py-1.5 rounded-lg text-xs font-medium border border-transparent bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700 transition capitalize';
                }
            });

            filterTemplates();
        }

        function filterTemplates() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase().trim();
            
            filteredTemplates = allTemplates.filter(t => {
                const provider = (t.provider || t.id.split('/')[0]).toLowerCase();
                const meta = t.metadata || {};
                
                const matchesFilter = currentFilter === 'all' || provider === currentFilter;
                const matchesSearch = !searchTerm || 
                    (t.id || '').toLowerCase().includes(searchTerm) ||
                    (meta.name || '').toLowerCase().includes(searchTerm) ||
                    (meta.description || '').toLowerCase().includes(searchTerm) ||
                    (meta.author || '').toLowerCase().includes(searchTerm) ||
                    provider.includes(searchTerm);

                return matchesFilter && matchesSearch;
            });

            renderContent(filteredTemplates);
        }

        // --- Render Content ---

        function switchView(view) {
            currentView = view;
            document.getElementById('btn-grid').classList.toggle('active', view === 'grid');
            document.getElementById('btn-table').classList.toggle('active', view === 'table');
            renderContent(filteredTemplates);
        }

        function renderContent(templates) {
            const container = document.getElementById('content-area');
            const resultCount = document.getElementById('result-count');
            
            resultCount.textContent = `${templates.length} items`;

            if (templates.length === 0) {
                renderEmptyState(container);
                return;
            }

            if (currentView === 'grid') {
                renderGrid(container, templates);
            } else {
                renderTable(container, templates);
            }
            
            lucide.createIcons();
        }

        function renderGrid(container, templates) {
            container.className = "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6";
            
            const html = templates.map(t => {
                const meta = t.metadata || {};
                const name = meta.name || t.slug;
                const desc = meta.description || 'No description provided';
                const author = meta.author || 'Unknown';
                const version = t.latest || t.version || '0.0.1';
                const provider = t.provider || t.id.split('/')[0];
                const colorData = getProviderColor(provider);

                return `
                <div class="glass-card rounded-xl p-6 flex flex-col h-full group relative overflow-hidden animate-fade-in min-h-[260px]">
                    <div class="absolute top-0 left-0 w-full h-[2px] bg-gradient-to-r from-transparent via-primary-500/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                    
                    <div class="flex justify-between items-start mb-4">
                        <span class="px-2.5 py-1 text-[11px] font-bold uppercase tracking-wider rounded border" style="${colorData.style}">
                            ${provider}
                        </span>
                        <span class="text-[11px] font-mono text-slate-500 bg-slate-800/50 px-2 py-1 rounded border border-slate-700/50">v${version}</span>
                    </div>

                    <h3 class="text-lg font-bold text-slate-200 group-hover:text-primary-400 transition cursor-pointer mb-2 line-clamp-1"
                        onclick="openModal('${t.id}')" title="${name}">
                        ${name}
                    </h3>
                    
                    <p class="text-slate-400 text-sm leading-relaxed mb-5 line-clamp-2 h-[40px]">
                        ${desc}
                    </p>

                    <div class="mt-auto pt-4 border-t border-slate-700/50 flex flex-col gap-3">
                        <div class="flex justify-between items-center text-xs text-slate-500">
                             <div class="flex items-center gap-1.5">
                                <i data-lucide="user" class="w-3 h-3"></i>
                                <span class="truncate max-w-[100px]">${author}</span>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-4 gap-2">
                             <button onclick="copyCommand('redc pull ${t.id}')" 
                                class="col-span-3 flex items-center justify-center gap-2 py-2 bg-slate-800 hover:bg-primary-600 hover:text-white text-slate-300 text-xs font-medium rounded-lg border border-slate-700 hover:border-primary-500 transition-all active:scale-95">
                                <i data-lucide="terminal" class="w-3 h-3"></i>
                                Pull
                            </button>
                            <a href="${t.versions?.[version]?.url || '#'}" class="col-span-1 flex items-center justify-center bg-slate-800 hover:bg-slate-700 text-slate-400 hover:text-white rounded-lg border border-slate-700 transition">
                                <i data-lucide="download" class="w-4 h-4"></i>
                            </a>
                        </div>
                    </div>
                </div>`;
            }).join('');
            
            container.innerHTML = html;
        }

        function renderTable(container, templates) {
            container.className = "w-full overflow-x-auto rounded-xl border border-slate-700/50 bg-[#151725]/50 animate-fade-in";
            
            const t = translations[currentLang];
            
            let rows = templates.map(item => {
                const meta = item.metadata || {};
                const version = item.latest || item.version || '0.0.1';
                const provider = item.provider || item.id.split('/')[0];
                const colorData = getProviderColor(provider);
                
                return `
                <tr class="group hover:bg-slate-800/30 transition-colors">
                    <td class="whitespace-nowrap">
                        <span class="px-2 py-1 text-[10px] font-bold uppercase rounded border inline-block w-20 text-center" style="${colorData.style}">
                            ${provider}
                        </span>
                    </td>
                    <td class="font-medium text-slate-200 cursor-pointer hover:text-primary-400" onclick="openModal('${item.id}')">
                        ${meta.name || item.slug}
                    </td>
                    <td class="text-slate-400 max-w-xs truncate" title="${meta.description}">
                        ${meta.description || '-'}
                    </td>
                    <td class="whitespace-nowrap">
                        <div class="flex items-center gap-1.5">
                            <i data-lucide="user" class="w-3 h-3 text-slate-600"></i>
                            <span>${meta.author || 'Unknown'}</span>
                        </div>
                    </td>
                    <td class="font-mono text-xs text-slate-500">v${version}</td>
                    <td>
                        <div class="flex items-center gap-2">
                            <div class="group/tip relative">
                                <button onclick="copyCommand('redc pull ${item.id}')" class="p-1.5 rounded-md hover:bg-primary-600 hover:text-white text-slate-400 transition">
                                    <i data-lucide="terminal" class="w-4 h-4"></i>
                                </button>
                            </div>
                            <a href="${item.versions?.[version]?.url || '#'}" class="p-1.5 rounded-md hover:bg-slate-700 text-slate-400 hover:text-white transition">
                                <i data-lucide="download" class="w-4 h-4"></i>
                            </a>
                            <button onclick="openModal('${item.id}')" class="p-1.5 rounded-md hover:bg-slate-700 text-slate-400 transition">
                                <i data-lucide="file-text" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </td>
                </tr>
                `;
            }).join('');

            const tableHtml = `
            <table class="w-full text-left border-collapse custom-table">
                <thead class="bg-slate-800/50 backdrop-blur">
                    <tr>
                        <th class="w-24">${t.table_provider}</th>
                        <th class="w-48">${t.table_name}</th>
                        <th>${t.table_desc}</th>
                        <th class="w-32">${t.table_author}</th>
                        <th class="w-20">${t.table_version}</th>
                        <th class="w-24 text-right">${t.table_action}</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-slate-800/50">
                    ${rows}
                </tbody>
            </table>
            `;
            
            container.innerHTML = tableHtml;
        }

        function renderEmptyState(container) {
            container.className = "w-full";
            const t = translations[currentLang];
            container.innerHTML = `
                <div class="text-center py-20 animate-fade-in border border-dashed border-slate-700 rounded-xl bg-slate-800/20">
                    <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-slate-800/50 mb-4">
                        <i data-lucide="package-search" class="w-8 h-8 text-slate-500"></i>
                    </div>
                    <h3 class="text-lg font-bold text-white mb-2">${t.no_results}</h3>
                    <p class="text-slate-400 text-sm">${t.no_results_hint}</p>
                    <button onclick="clearSearch()" class="mt-4 px-4 py-2 bg-slate-800 hover:bg-slate-700 text-white rounded-lg transition text-sm border border-slate-700">
                        ${t.clear_search}
                    </button>
                </div>
            `;
        }

        // --- Config Tab Switcher ---
        function switchConfigTab(tab) {
            document.getElementById('content-file').classList.toggle('hidden', tab !== 'file');
            document.getElementById('content-env').classList.toggle('hidden', tab !== 'env');
            
            // Update active styles
            const btnFile = document.getElementById('tab-file');
            const btnEnv = document.getElementById('tab-env');
            
            if (tab === 'file') {
                btnFile.className = "flex-1 text-[10px] py-1 text-yellow-300 bg-slate-800/50 font-semibold border-b-2 border-yellow-500/50 transition";
                btnEnv.className = "flex-1 text-[10px] py-1 text-slate-500 hover:text-slate-300 hover:bg-slate-800/30 transition";
            } else {
                btnEnv.className = "flex-1 text-[10px] py-1 text-blue-300 bg-slate-800/50 font-semibold border-b-2 border-blue-500/50 transition";
                btnFile.className = "flex-1 text-[10px] py-1 text-slate-500 hover:text-slate-300 hover:bg-slate-800/30 transition";
            }
        }

        // --- Utils ---

        function getProviderColor(provider) {
            const map = {
                aliyun: '#ff6a00', alibaba: '#ff6a00',
                tencent: '#0052d9',
                aws: '#ff9900',
                azure: '#0078D4', microsoft: '#0078D4',
                google: '#4285F4', gcp: '#4285F4',
                huawei: '#C8102E',
                vultr: '#007bfc'
            };
            const color = map[provider.toLowerCase()] || '#64748b';
            return {
                hex: color,
                style: `color: ${color}; border-color: ${color}33; background-color: ${color}1a;`
            };
        }

        // --- Search ---

        function setupSearch() {
            const input = document.getElementById('search-input');
            const debounce = (fn, delay) => {
                let timer;
                return (...args) => {
                    clearTimeout(timer);
                    timer = setTimeout(() => fn(...args), delay);
                }
            };

            input.addEventListener('input', debounce(() => filterTemplates(), 300));
        }

        function clearSearch() {
            const input = document.getElementById('search-input');
            input.value = '';
            input.dispatchEvent(new Event('input'));
        }

        // --- Modal ---

        function openModal(id) {
            const t = allTemplates.find(item => item.id === id);
            if (!t) return;

            const meta = t.metadata || {};
            const version = t.latest || t.version;
            const lang = translations[currentLang];
            const provider = t.provider || t.id.split('/')[0];
            const colorData = getProviderColor(provider);

            // Populate Header Metadata
            document.getElementById('modal-title').innerHTML = `
                <span class="px-2 py-1 text-sm font-bold uppercase rounded border tracking-wider" style="${colorData.style}">${provider}</span>
                <span class="text-white">${meta.name || t.slug}</span>
            `;
            
            document.getElementById('modal-cmd').textContent = `redc pull ${t.id}`;
            document.getElementById('modal-pull-cmd-container').onclick = () => copyCommand(`redc pull ${t.id}`);
            
            document.getElementById('modal-author').textContent = meta.author || 'Unknown';
            document.getElementById('modal-version').textContent = `v${version}`;
            document.getElementById('modal-desc').textContent = meta.description || 'No description available.';

            // Content
            const readmeRaw = meta.readme || lang.no_readme;
            const htmlContent = DOMPurify.sanitize(marked.parse(readmeRaw));
            document.getElementById('markdown-content').innerHTML = htmlContent;

            // Footer Info
            document.getElementById('modal-footer-info').textContent = `ID: ${t.id} • SHA: ${t.versions?.[version]?.sha256?.substring(0,8) || 'N/A'}`;

            // Animation
            const modal = document.getElementById('modal');
            const backdrop = document.getElementById('modal-backdrop');
            const panel = document.getElementById('modal-panel');

            modal.classList.remove('hidden');
            requestAnimationFrame(() => {
                backdrop.classList.remove('opacity-0');
                panel.classList.remove('opacity-0', 'scale-95');
                panel.classList.add('scale-100');
            });
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            const modal = document.getElementById('modal');
            const backdrop = document.getElementById('modal-backdrop');
            const panel = document.getElementById('modal-panel');

            backdrop.classList.add('opacity-0');
            panel.classList.remove('scale-100');
            panel.classList.add('opacity-0', 'scale-95');

            setTimeout(() => {
                modal.classList.add('hidden');
                document.body.style.overflow = 'auto';
            }, 300);
        }

        // --- I18N Switching ---

        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('redc-lang', lang);
            
            document.documentElement.lang = lang;
            document.getElementById('lang-text').textContent = lang === 'zh-CN' ? 'EN' : '中文';
            
            // Use innerHTML to allow HTML tags like <br>
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[lang][key]) el.innerHTML = translations[lang][key];
            });
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (translations[lang][key]) el.placeholder = translations[lang][key];
            });

            // Re-render dynamic content (filters update, table headers etc)
            filterTemplates();
        }

        function toggleLanguage() {
            setLanguage(currentLang === 'zh-CN' ? 'en' : 'zh-CN');
        }

        // --- Clipboard ---

        function copyCommand(text) {
            navigator.clipboard.writeText(text).then(() => {
                const toast = document.getElementById('toast');
                const toastBody = document.getElementById('toast-body');
                const lang = translations[currentLang];
                
                toastBody.querySelector('span').textContent = lang.copied;
                toastBody.classList.remove('translate-y-20', 'opacity-0');
                
                setTimeout(() => {
                    toastBody.classList.add('translate-y-20', 'opacity-0');
                }, 2000);
            });
        }

        // --- Event Listeners ---
        document.getElementById('modal-backdrop').addEventListener('click', closeModal);
        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });

        // Initialize Config Tab
        switchConfigTab('file');

    </script>
</body>
</html>
